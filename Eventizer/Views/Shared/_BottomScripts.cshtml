@model Eventizer.Models.Current
<script>
    function initAjaxRequest($control, URL, redirectURL) {
        var request;
        $control.submit(function (e) {

            if (request) {
                request.abort();
            }
            var $form = $(this);
            var $inputs = $form.find("input, select, button, textarea");
            var serializedData = $form.serialize();

            $inputs.prop("disabled", true);

            console.log(serializedData);

            request = $.ajax({
                url: URL,
                type: "post",
                data: serializedData
            });

            request.done(function (response, textStatus, jqXHR) {
                $('.alert').hide();

                console.log(response);
                console.log(redirectURL + response);
                if (response == 0) {
                    $('.alert-danger').stop().fadeIn();
                }
                else if (response >= 1) {
                    $('.alert-success').stop().fadeIn();
                    setTimeout(function () { window.location = redirectURL + response; }, 1000);
                }
                else {
                    $('.alert-warning').stop().fadeIn();
                }
            });

            request.fail(function (jqXHR, textStatus, errorThrown) {
                console.error(
                    "The following error occured: " +
                        textStatus, errorThrown
                );
            });

            request.always(function () {
                $inputs.prop("disabled", false);
            });

            e.preventDefault();
        });
    }
    $(document).ready(function () {
        initAjaxRequest($('#event-form'), "@Url.Action("CreateEvent", "Ajax")", "@Href("/Dashboard/events/view/")");
        initAjaxRequest($('#task-form'), "@Url.Action("CreateTask", "Ajax")", "@Href("/Tasks/view/")");
    });
</script>
